<div ng-if="ctrl.dataSet.$resolved && ctrl.dataSet.id" flex ngf-drop="ctrl.uploadTexTemplate($files)" ngf-multiple="true" ngf-include-dir="false" ngf-drag-over-class="{accept:'fdz-file-drop-accept', delay:0}" ngf-drop-disabled="!ctrl.isAuthenticated() || !ctrl.hasAuthority('ROLE_PUBLISHER')">
    <div layout="row" style="margin-bottom: 0px;" layout-margin>
        <h1 class="md-headline" style="margin-left: 0px;">{{ctrl.dataSet.description[currentLanguage]}} <span class="label label-as-badge label-default">{{ctrl.dataSet.id}}</span></h1>
    </div>
    <div layout="column" layout-gt-sm="row">
        <md-card flex-gt-sm>
            <md-card-header>
                <md-card-header-text>
                    <h2 class="md-title">{{'global.cards.details' | translate }}</h2>
                </md-card-header-text>
            </md-card-header>
            <md-divider></md-divider>
            <md-card-content>
                <div style="margin-bottom: 0.5em;" ng-if="ctrl.dataSet.type">
                    <span style="font-weight: bold;">{{'data-set-management.detail.type' | translate }}:
                        </span>
                    <span>{{ctrl.dataSet.type[currentLanguage]}}</span>
                </div>
                <div style="margin-bottom: 0.5em;" ng-if="ctrl.dataSet.format">
                    <span style="font-weight: bold;">{{'data-set-management.detail.format' | translate }}:
                        </span>
                    <span>{{ctrl.dataSet.format[currentLanguage]}}</span>
                </div>
            </md-card-content>
        </md-card>
        <md-card flex-gt-sm="40" ng-class="{'fdz-reset-left-margin': $mdMedia('gt-sm'), 'fdz-reset-top-margin': $mdMedia('sm') || $mdMedia('xs')}">
            <md-card-header>
                <md-card-header-text>
                    <h2 class="md-title">{{'global.cards.related-objects' | translate }}</h2>
                </md-card-header-text>
            </md-card-header>
            <md-divider></md-divider>
            <md-card-content>
                <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                    <div ng-if="!ctrl.study" class="fdz-truncate-string" flex>
                        <md-icon md-svg-src="/assets/images/icons/study.svg"></md-icon>
                        {{'study-management.detail.study' | translate }}: {{'global.messages.error.unavailable' | translate}}
                    </div>
                    <div ng-if="ctrl.study" class="fdz-truncate-string" flex>
                        <a ui-sref="studyDetail({id: ctrl.study.id})">
                            <md-icon md-svg-src="/assets/images/icons/study.svg"></md-icon>
                            {{'study-management.detail.study' | translate }}: {{ctrl.study.title[currentLanguage]}}</a>
                    </div>
                </div>
                <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                    <div ng-if="ctrl.counts.surveysCount == 0" class="fdz-truncate-string" flex>
                        <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                        {{'survey-management.detail.surveys' | translate }}: {{'global.messages.error.unavailable' | translate}}
                    </div>
                    <div ng-if="ctrl.counts.surveysCount == 1" class="fdz-truncate-string" flex>
                        <a ui-sref="surveyDetail({'id': ctrl.survey.id})">
                            <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                            {{'survey-management.detail.survey' | translate }}: {{ctrl.survey.title[currentLanguage]}}</a>
                    </div>
                    <div ng-if="ctrl.counts.surveysCount > 1" class="fdz-truncate-string" flex>
                        <a ui-sref="search({'type': 'surveys', 'data-set': ctrl.dataSet.id, 'page': 1})">
                            <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                            {{'survey-management.detail.surveys' | translate }}: ({{ctrl.counts.surveysCount}})</a>
                    </div>
                </div>
                <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                    <div ng-if="ctrl.counts.variablesCount == 0" class="fdz-truncate-string" flex>
                        <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                        {{'variable-management.detail.variables' | translate }}: {{'global.messages.error.unavailable' | translate}}
                    </div>
                    <div ng-if="ctrl.counts.variablesCount == 1" class="fdz-truncate-string" flex>
                        <a ui-sref="variableDetail({'id': ctrl.variable.id})">
                            <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                            {{'variable-management.detail.variable' | translate }}: {{ctrl.variable.label[currentLanguage]}}</a>
                    </div>
                    <div ng-if="ctrl.counts.variablesCount > 1" class="fdz-truncate-string" flex>
                        <a ui-sref="search({'type': 'variables', 'data-set': ctrl.dataSet.id, 'page': 1, 'sort-by': 'indexInDataSet'})">
                            <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                            {{'variable-management.detail.variables' | translate }}: ({{ctrl.counts.variablesCount}})</a>
                    </div>
                </div>
                <div ng-if="ctrl.counts.dataSetsCount !== 1" style="margin-bottom: 0.5em; width: 100%;" layout="row">
                    <div ng-if="ctrl.counts.dataSetsCount == 0" class="fdz-truncate-string" flex>
                        <md-icon md-svg-src="/assets/images/icons/data-set.svg"></md-icon>
                        {{'data-set-management.detail.data-set-same-study' | translate }}: {{'global.messages.error.unavailable' | translate}}
                    </div>
                    <div ng-if="ctrl.counts.dataSetsCount > 1" class="fdz-truncate-string" flex>
                        <a ui-sref="search({'type': 'data_sets', 'study':ctrl.dataSet.studyId, 'page': 1})">
                            <md-icon md-svg-src="/assets/images/icons/data-set.svg"></md-icon>
                            {{'data-set-management.detail.data-set-same-study' | translate }}: ({{ctrl.counts.dataSetsCount}})</a>
                    </div>
                </div>
                <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                    <div ng-if="ctrl.counts.publicationsCount == 0" class="fdz-truncate-string" flex>
                        <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                        {{'related-publication-management.detail.publications' | translate }}: {{'global.messages.error.unavailable' | translate}}
                    </div>
                    <div ng-if="ctrl.counts.publicationsCount == 1" class="fdz-truncate-string" flex>
                        <a ui-sref="relatedPublicationDetail({'id': ctrl.relatedPublication.id})">
                            <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                            {{'related-publication-management.detail.publication' | translate }}: {{ctrl.relatedPublication.title}}</a>
                    </div>
                    <div ng-if="ctrl.counts.publicationsCount > 1" class="fdz-truncate-string" flex>
                        <a ui-sref="search({'type': 'related_publications', 'data-set':ctrl.dataSet.id, 'page': 1})">
                            <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                            {{'related-publication-management.detail.publications' | translate }}: ({{ctrl.counts.publicationsCount}})</a>
                    </div>
                </div>
            </md-card-content>
        </md-card>
    </div>
    <div layout="row">
        <md-card flex class="fdz-reset-top-margin">
            <md-card-header layout-align="center center">
                <md-card-header-text>
                    <h2 class="md-title">{{'data-set-management.detail.sub-data-sets.title' | translate }}</h2>
                </md-card-header-text>
            </md-card-header>
            <table class="fdz-table">
                <thead>
                    <tr>
                        <th>{{'data-set-management.detail.sub-data-sets.name' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'data-set-management.detail.sub-data-sets.name' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'data-set-management.detail.sub-data-sets.description' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'data-set-management.detail.sub-data-sets.description' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'data-set-management.detail.sub-data-sets.accessWay' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'data-set-management.detail.sub-data-sets.accessWay' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'data-set-management.detail.sub-data-sets.numberOfAnalyzedVariables' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'data-set-management.detail.sub-data-sets.numberOfAnalyzedVariables' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'data-set-management.detail.sub-data-sets.numberOfObservations' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'data-set-management.detail.sub-data-sets.numberOfObservations' | translate }}
                            </md-tooltip>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="row in ctrl.dataSet.subDataSets">
                        <td>{{row.name}}&nbsp;</td>
                        <td>{{row.description[currentLanguage]}}&nbsp;</td>
                        <td>{{row.accessWay}}</td>
                        <td>
                        <a ui-sref="search({'type': 'variables', 'data-set':ctrl.dataSet.id, 'page': 1, 'access-way': row.accessWay,'sort-by': 'indexInDataSet'})">
                          {{ctrl.counts[row.name]}}&nbsp;</a>
                        </td>
                        <td>{{row.numberOfObservations}}&nbsp;</td>
                    </tr>
                </tbody>
            </table>
        </md-card>
    </div>
    <div ng-if="ctrl.isAuthenticated() && ctrl.hasAuthority('ROLE_PUBLISHER')" class="fdz-fab-button-container" layout="column">
        <md-button aria-label="{{'data-set-management.detail.generate-variable-report' | translate}}" type="file" ngf-select="ctrl.uploadTexTemplate($files)" ngf-multiple="true" directory webkitdirectory class="md-accent md-fab">
            <md-tooltip md-direction="left">
                    {{'data-set-management.detail.generate-variable-report' | translate}}
            </md-tooltip>
            <md-icon md-font-set="material-icons">note_add</md-icon>
        </md-button>
    </div>
</div>
