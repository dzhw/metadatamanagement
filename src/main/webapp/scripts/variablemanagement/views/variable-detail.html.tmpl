<div ng-if="variable.id">
    <div layout="row" style="margin-bottom: 0px;" layout-margin>
        <h1 class="md-headline" style="margin-left: 0px;"><span display-i18n-string=variable.label></span> <span class="label label-as-badge label-default">{{variable.id}}</span></h1>
    </div>
    <div layout="column" layout-gt-sm="row">
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto">
                <md-card-header>
                    <md-card-header-text>
                        <h2 class="md-title">{{'global.cards.details' | translate }}</h2>
                    </md-card-header-text>
                </md-card-header>
                <md-divider></md-divider>
                <md-card-content>
                    <div class="fdz-add-bottom-margin" ng-if="variable.name">
                        <span style="font-weight: bold;">{{'variable-management.detail.name' | translate }}:</span>
                        <span>{{variable.name}}</span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="variable.label">
                        <span style="font-weight: bold;">{{'variable-management.detail.label' | translate }}:</span>
                        <span display-i18n-string="variable.label"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="variable.dataType">
                        <span style="font-weight: bold;">{{'variable-management.detail.data-type' | translate }}:</span>
                        <span display-i18n-string="variable.dataType"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="variable.scaleLevel">
                        <span style="font-weight: bold;">{{'variable-management.detail.scale-level' | translate }}:</span>
                        <span display-i18n-string="variable.scaleLevel"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="variable.accessWays">
                        <span style="font-weight: bold;">{{'variable-management.detail.access-ways' | translate }}:</span>
                        <span>{{variable.accessWays.join(', ')}}</span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="variable.annotations">
                        <span style="font-weight: bold;">{{'variable-management.detail.annotations' | translate }}:</span>
                        <span display-i18n-string="variable.annotations"></span>
                    </div>
                    <div class="fdz-add-bottom-margin" ng-if="variable.filterDetails.description">
                        <span style="font-weight: bold;">{{'variable-management.detail.filter-description' | translate }}:</span>
                        <span display-i18n-string="variable.filterDetails.description"></span>
                    </div>
                    <div ng-if="variable.filterDetails">
                        <span style="font-weight: bold;">{{'variable-management.detail.input-filter' | translate }} ({{variable.filterDetails.expressionLanguage}}):</span>
                        <div class="fdz-overlay-outer-box">
                            <div hljs hljs-language="{{variable.filterDetails.expressionLanguage}}" hljs-source="variable.filterDetails.expression" style="margin-top: 0.5em;" class="fdz-code-container" ng-class="{'fdz-hidden-code': filterDetailsCodeToggleFlag}" create-variable-links="{currentLanguage: currentLanguage, currentVariable: variable}"></div>
                            <div class="fdz-overlay-inner-box-top">
                                <md-button ng-click="openSuccessCopyToClipboardToast('variable-management.log-messages.variable.filter-details-success-copy-to-clipboard')" class="md-icon-button md-primary" ngclipboard data-clipboard-text="{{variable.filterDetails.expression}}">
                                    <md-icon md-font-library="material-icons">content_copy</md-icon>
                                    <md-tooltip md-direction="top" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                        {{'variable-management.detail.copy-complete-input-filter-tooltip' | translate}}
                                    </md-tooltip>
                                </md-button>
                                <md-button class="md-icon-button md-primary" ng-click="toggleFilterDetailsCode()">
                                    <md-icon ng-if="filterDetailsCodeToggleFlag" md-svg-src="/assets/images/icons/arrow-expand.svg"></md-icon>
                                    <md-icon ng-if="!filterDetailsCodeToggleFlag" md-svg-src="/assets/images/icons/arrow-compress.svg"></md-icon>
                                    <md-tooltip md-direction="top" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                        {{'variable-management.detail.show-complete-input-filter-tooltip.' + filterDetailsCodeToggleFlag | translate }}
                                    </md-tooltip>
                                </md-button>
                            </div>
                        </div>
                    </div>
                </md-card-content>
            </md-card>
        </div>
        <div flex-gt-sm="50" layout="column">
            <md-card flex="auto" ng-class="{'fdz-reset-left-margin': $mdMedia('gt-sm'), 'fdz-reset-top-margin': $mdMedia('sm') || $mdMedia('xs')}">
                <md-card-header>
                    <md-card-header-text>
                        <h2 class="md-title">{{'global.cards.related-objects' | translate }}</h2>
                    </md-card-header-text>
                </md-card-header>
                <md-divider></md-divider>
                <md-card-content layout="column">
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="!study" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/study.svg"></md-icon>
                            {{'study-management.detail.study' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="study" class="fdz-truncate-string" flex>
                            <a ui-sref="studyDetail({id: study.id})">
                                <md-icon md-svg-src="/assets/images/icons/study.svg"></md-icon>
                                {{'study-management.detail.study' | translate }}: <span display-i18n-string="study.title"></span>
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.studies.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                      <div ng-if="counts.surveysCount == 0" class="fdz-truncate-string" flex>
                        <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                        {{'survey-management.detail.surveys' | translate }}: {{'global.messages.error.unavailable' | translate}}
                      </div>
                      <div ng-if="counts.surveysCount == 1 && survey" class="fdz-truncate-string" flex>
                        <a ui-sref="surveyDetail({'id': survey.id})">
                          <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                          {{'survey-management.detail.survey' | translate }}: <span display-i18n-string="survey.title"></span>
                          <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                            {{'variable-management.detail.tooltips.surveys.one' | translate}}
                          </md-tooltip>
                        </a>
                      </div>
                      <div ng-if="counts.surveysCount > 1" class="fdz-truncate-string" flex>
                        <a ui-sref="search({'type': 'surveys', 'variable':variable.id, 'page': 1})">
                          <md-icon md-svg-src="/assets/images/icons/survey.svg"></md-icon>
                          {{'survey-management.detail.surveys' | translate }}: ({{counts.surveysCount}})
                          <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                            {{'variable-management.detail.tooltips.surveys.many' | translate}}
                          </md-tooltip>
                        </a>
                      </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="!dataSet" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/data-set.svg"></md-icon>
                            {{'data-set-management.detail.data-set' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="dataSet" class="fdz-truncate-string" flex>
                            <a ui-sref="dataSetDetail({id: dataSet.id})">
                                <md-icon md-svg-src="/assets/images/icons/data-set.svg"></md-icon>
                                {{'data-set-management.detail.data-set' | translate }}: <span display-i18n-string="dataSet.description"></span>
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.data-sets.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="counts.questionsCount == 0" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/question.svg"></md-icon>
                            {{'question-management.detail.questions' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="counts.questionsCount == 1 && question" class="fdz-truncate-string" flex>
                            <a ui-sref="questionDetail({'id': question.id})">
                                <md-icon md-svg-src="/assets/images/icons/question.svg"></md-icon>
                                {{'question-management.detail.question' | translate }}: <span display-i18n-string="question.questionText"></span>
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.questions.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                        <div ng-if="counts.questionsCount > 1" class="fdz-truncate-string" flex>
                            <a ui-sref="search({'type': 'questions', 'variable':variable.id, 'page': 1})">
                                <md-icon md-svg-src="/assets/images/icons/question.svg"></md-icon>
                                {{'question-management.detail.questions' | translate }}: ({{counts.questionsCount}})
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.questions.many' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div ng-if="counts.variablesInPanel !== 1" style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="counts.variablesInPanel == 0" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                            {{'variable-management.detail.variables-in-panel' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="counts.variablesInPanel > 1" class="fdz-truncate-string" flex>
                            <a ui-sref="search({'type': 'variables', 'panel-identifier':variable.panelIdentifier, 'page': 1})">
                                <md-icon md-svg-src="/assets/images/icons/variable.svg"></md-icon>
                                {{'variable-management.detail.variables-in-panel' | translate }}: ({{counts.variablesInPanel}})
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.variables.same-in-panel' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                    <div style="margin-bottom: 0.5em; width: 100%;" layout="row">
                        <div ng-if="counts.publicationsCount == 0" class="fdz-truncate-string" flex>
                            <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                            {{'related-publication-management.detail.publications' | translate }}: {{'global.messages.error.unavailable' | translate}}
                        </div>
                        <div ng-if="counts.publicationsCount == 1" class="fdz-truncate-string" flex>
                            <a ui-sref="relatedPublicationDetail({'id': relatedPublication.id})">
                                <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                                {{'related-publication-management.detail.publication' | translate }}: {{relatedPublication.title}}
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.publications.one' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                        <div ng-if="counts.publicationsCount > 1" class="fdz-truncate-string" flex>
                            <a ui-sref="search({'type': 'related_publications', 'variable':variable.id, 'page': 1})">
                                <md-icon md-svg-src="/assets/images/icons/related-publication.svg"></md-icon>
                                {{'related-publication-management.detail.publications' | translate }}: ({{counts.publicationsCount}})
                                <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.tooltips.publications.many' | translate}}
                                </md-tooltip>
                            </a>
                        </div>
                    </div>
                </md-card-content>
            </md-card>
        </div>
    </div>
    <div layout="column" layout-gt-sm="row">
         <div flex-gt-sm="50" layout="column">
           <md-card flex="auto" ng-if="validResponsesOrMissingsAvailable" class="fdz-reset-top-margin">
             <md-card-header>
               <md-card-header-text>
                 <h2 class="md-title">{{'variable-management.detail.statistics.graphics' | translate }}</h2>
               </md-card-header-text>
             </md-card-header>
             <md-divider></md-divider>
             <div id="diagramContainer">
               <diagram distribution="variable.distribution" datatype="variable.dataType['en']" type="variable.scaleLevel[currentLanguage]" language="currentLanguage" ng-cloak></diagram>
             </div>
           </md-card>
         </div>
         <div flex-gt-sm="50" layout="column">
           <md-card flex="auto" class="fdz-reset-top-margin" ng-class="{'fdz-reset-left-margin': $mdMedia('gt-sm') && validResponsesOrMissingsAvailable }">
             <md-card-header>
               <md-card-header-text>
                 <h2 class="md-title">{{'variable-management.detail.statistics.statistics' | translate }}</h2>
               </md-card-header-text>
             </md-card-header>
             <md-divider></md-divider>
             <md-card-content ng-cloak="true">
               <div>
                 <div class="fdz-add-bottom-margin" ng-if="variable.distribution.validResponses">
                   {{'variable-management.detail.statistics.validResponses' | translate}}: {{variable.distribution.validResponses.length}}</div>
                 <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.minimum != null">
                   {{'variable-management.detail.statistics.minimum' | translate}} <span katex>(min)</span>: {{variable.distribution.statistics.minimum | variableDataType: variable.dataType.en}}
                 </div>
                 <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.maximum != null">
                   {{'variable-management.detail.statistics.maximum' | translate}} <span katex>(max)</span>: {{variable.distribution.statistics.maximum | variableDataType: variable.dataType.en}}
                 </div>
                 <h3 style="font-size: 18px; margin-top: 1.0em; margin-bottom: 0.5em;" ng-if="checkCentralTendencyElements()">
                   {{'variable-management.detail.central-tendency' | translate}}
                 </h3>
                 <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.meanValue != null">
                   {{'variable-management.detail.statistics.mean-value' | translate}} <span katex>(\bar x)</span>: {{variable.distribution.statistics.meanValue | number:2}}
                 </div>
                  <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.median != null">
                    {{'variable-management.detail.statistics.median' | translate}} <span katex>(\tilde x)</span>: {{variable.distribution.statistics.median | variableDataType: variable.dataType.en}}
                  </div>
                  <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.mode != null">
                    {{'variable-management.detail.statistics.mode' | translate}} <span katex>(h)</span>: {{variable.distribution.statistics.mode}}
                  </div>
                  <h3 style="font-size: 18px; margin-top: 1.0em; margin-bottom: 0.5em;" ng-if="checkDispersionElements()">
                    {{'variable-management.detail.dispersion' | translate}}
                  </h3>
                  <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.deviance != null">
                    {{'variable-management.detail.statistics.deviance' | translate}} <span katex>(d)</span>: {{variable.distribution.statistics.deviance | number:2}}
                  </div>
                  <h3 style="font-size: 18px; margin-top: 1.0em; margin-bottom: 0.5em;" ng-if="checkDistributionElements()">
                    {{'variable-management.detail.distribution' | translate}}
                  </h3>
                  <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.skewness != null">
                    {{'variable-management.detail.statistics.skewness' | translate}} <span katex>(v)</span>: {{variable.distribution.statistics.skewness | number:2}}
                  </div>
                  <div class="fdz-add-bottom-margin" ng-if="variable.distribution.statistics.kurtosis != null">
                    {{'variable-management.detail.statistics.kurtosis' | translate}} <span katex>(w)</span>: {{variable.distribution.statistics.kurtosis | number:2}}
                  </div>
                </div>
              </md-card-content>
           </md-card>
         </div>
    </div>
    <div layout="row" ng-if="validResponsesOrMissingsAvailable">
        <md-card flex class="fdz-reset-top-margin">
            <md-card-header class="fdz-card-header-with-button" layout-align="center center">
                <md-card-header-text>
                    <h2 class="md-title">{{'variable-management.detail.frequencies' | translate }}</h2>
                </md-card-header-text>
                <md-button ng-disabled="!variable.distribution.validResponses || variable.distribution.validResponses.length <= 10" class="md-fab md-mini md-primary" ng-click="toggleAllRowsVisible()">
                    <md-tooltip ng-hide="!variable.distribution.validResponses || variable.distribution.validResponses.length <= 10" md-direction="left" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                        {{'variable-management.detail.show-complete-distribution-tooltip.' + notAllRowsVisible | translate }}
                    </md-tooltip>
                    <md-icon ng-if="notAllRowsVisible" md-svg-src="/assets/images/icons/arrow-expand.svg"></md-icon>
                    <md-icon ng-if="!notAllRowsVisible" md-svg-src="/assets/images/icons/arrow-compress.svg"></md-icon>
                </md-button>
            </md-card-header>
            <table fdz-table>
                <thead>
                    <tr>
                        <th>{{'variable-management.detail.statistics.value' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'variable-management.detail.statistics.value' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'variable-management.detail.statistics.label' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'variable-management.detail.statistics.label' | translate }}
                            </md-tooltip>
                        </th>
                        <th>Missing
                        </th>
                        <th>{{'variable-management.detail.statistics.frequency' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'variable-management.detail.statistics.frequency' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'variable-management.detail.statistics.valid-percent' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'variable-management.detail.statistics.valid-percent' | translate }}
                            </md-tooltip>
                        </th>
                        <th>{{'variable-management.detail.statistics.percent' | translate }}
                            <md-tooltip hide-gt-xs md-direction="right">
                                {{'variable-management.detail.statistics.percent' | translate }}
                            </md-tooltip>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-class="{'fdz-table-last-row':$last}" ng-repeat-start="row in variable.distribution.validResponses" ng-hide="isRowHidden($index)">
                        <td>{{row.value | variableDataType: variable.dataType.en}}{{row.code | number:0}}&nbsp;</td>
                        <td display-i18n-string="row.label"></td>
                        <td>&nbsp;</td>
                        <td>{{row.absoluteFrequency | number:0}}&nbsp;</td>
                        <td>{{row.validRelativeFrequency | number:2}} %
                        </td>
                        <td>{{row.relativeFrequency | number:2}} %
                        </td>
                    </tr>
                    <tr ng-repeat-end ng-if="$index === 4 && variable.distribution.validResponses.length > 10" ng-hide="!notAllRowsVisible">
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                        <td>...</td>
                    </tr>
                    <tr ng-if="variable.distribution.validResponses.length > 0">
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>{{variable.distribution.totalValidAbsoluteFrequency | number:0}}</td>
                        <td>100 %</td>
                        <td>{{variable.distribution.totalValidRelativeFrequency | number:2}} %
                        </td>
                    </tr>
                    <tr ng-class="{'fdz-table-last-row':$last}" ng-repeat="row in variable.distribution.missings">
                        <td>{{row.code}}&nbsp;</td>
                        <td display-i18n-string="row.label"></td>
                        <td>m</td>
                        <td>{{row.absoluteFrequency | number:0}}&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>{{row.relativeFrequency | number:2}} %
                        </td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>{{variable.distribution.totalAbsoluteFrequency | number:0}}</td>
                        <td>&nbsp;</td>
                        <td>100 %</td>
                    </tr>
                </tbody>
            </table>
        </md-card>
    </div>
    <div layout="row" ng-if="variable.generationDetails">
        <md-card flex class="fdz-reset-top-margin">
            <md-card-header layout-align="center center">
                <md-card-header-text>
                    <h2 class="md-title">{{'variable-management.detail.generation-details' | translate }}</h2>
                </md-card-header-text>
            </md-card-header>
            <md-divider></md-divider>
            <md-card-content>
                <div class="fdz-add-bottom-margin">
                    <span style="font-weight: bold;">{{'variable-management.detail.generation-details-description' | translate }}:
                    </span>
                    <span display-i18n-string="variable.generationDetails.description"></span>
                </div>
                <div ng-if="variable.generationDetails.rule">
                    <span style="font-weight: bold; margin-right:0px;">{{'variable-management.detail.generation-details-rule' | translate }}
                        ({{variable.generationDetails.ruleExpressionLanguage}}):
                    </span>
                    <div class="fdz-overlay-outer-box">
                        <div hljs hljs-source="variable.generationDetails.rule" hljs-language="{{variable.generationDetails.ruleExpressionLanguage}}" style="margin-top: 0.5em;" class="fdz-code-container" ng-class="{'fdz-hidden-code': generationCodeToggleFlag}" create-variable-links="{currentLanguage: currentLanguage, currentVariable: variable}"></div>
                        <div class="fdz-overlay-inner-box-top">
                            <md-button ng-click="openSuccessCopyToClipboardToast('variable-management.log-messages.variable.generation-details-rule-success-copy-to-clipboard')" class="md-icon-button md-primary" ngclipboard data-clipboard-text="{{variable.generationDetails.rule}}">
                                <md-icon md-font-library="material-icons">content_copy</md-icon>
                                <md-tooltip md-direction="top" md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                    {{'variable-management.detail.copy-complete-rule-tooltip' | translate}}
                                </md-tooltip>
                                </md-button>
                                <md-button class="md-icon-button md-primary" ng-click="toggleGenerationCode()">
                                    <md-icon ng-if="generationCodeToggleFlag" md-svg-src="/assets/images/icons/arrow-expand.svg"></md-icon>
                                    <md-icon ng-if="!generationCodeToggleFlag" md-svg-src="/assets/images/icons/arrow-compress.svg"></md-icon>
                                    <md-tooltip md-autohide="true" md-z-index="bowser.mobile || bowser.tablet ? -100 : 20">
                                        {{'variable-management.detail.show-complete-rule-tooltip.' + generationCodeToggleFlag | translate }}
                                    </md-tooltip>
                                </md-button>
                        </div>
                    </div>
                </div>
            </md-card-content>
        </md-card>
    </div>
</div>
